---
title: "Escenario COVID-19 en PERÚ"
description: |
  Covid-19 cases are growing to unparalleled worldwide, exceeding the regular numbers. One thing that is obvious, is that to adapt to change, but change is inevitable. We have undergone an extraordinary change in our way of life in the last few months due to COVID-19 and the same applies to this entire globe. Let’s look at the state of this pandemic, in the country of Peru also known as the Land of the Incas, with a population of 31.99 million in South America.
author:
  - name: Priya Ravindra Dingorkar
    url: https://www.linkedin.com/in/priya-dingorkar
    affiliation: Master's of Buisness Analytics, Monash University 
    affiliation_url: https://www.monash.edu/
date: 09-04-2020
output:
  distill::distill_article:
    self_contained: false
---

```{r, fig.align='center', out.width="100%"}
knitr::include_graphics("Data/Peru.jpg")
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(readr)
library(dplyr)
library(tidyverse)
library(coronavirus)
library(lubridate)
library(DT)
library(tidycovid19)
library(zoo)
library(kableExtra)
library(qwraps2)
library(ggplot2)
library(hrbrthemes)
library(plotly)

# Learn more about creating blogs with Distill at:
# https://rstudio.github.io/distill/blog.html
```

## Coronavirus Arrives in Peru

Coronavirus was first born in Wuhan China in the first week of December, this viruses causes problems with the respiratory system, thus infecting the body with mild to more severe diseases, this virus is easily contagious, close to contact with an infected individual. Good hand hygiene and cleanliness etiquette, social distancing and of course, the mask are one of the most effective steps to help prevent the virus from entering your system.

```{r, fig.cap= "Symptoms of COVID-19", fig.align='center', out.width="10%"}
knitr::include_graphics("Data/sym.jpg")
```

In this Blog, we will focus our discuss to COVID-19 and its impact in Peru. The virus was first  confirmed to have spread to Peru on 6 March 2020 when a 25-year-old man who had traveled to Spain, France and the Czech Republic tested positive. On 15 March 2020, President Martín Vizcarra declared a national shutdown, closing borders, barring domestic travel, and banning non-essential business operations — excluding health facilities, food vendors, pharmacies, and financial institutions. Peru, was one of the first countries to put the first lockdown in operation.

## Overview of the Virus in Peru

```{r}
peru_covid <- coronavirus %>% dplyr::filter(country == "Peru")

peru_covid_longer <- peru_covid %>% pivot_wider(values_from = "cases", names_from  = "type")

peru_covid_longer <- peru_covid_longer %>% mutate(month = month(date),
                                                   day = day(date), 
                                                  week = week(date))
peru_covid_longer <- peru_covid_longer %>% dplyr::select(date, 
                                   day,
                                   month,
                                   week, 
                                   confirmed,
                                   death, 
                                   recovered) 
```


```{r}
peru_stats <- read_csv("Data/datasets_705821_1232537_covid19_peru_stats.csv")

peru_stats <- peru_stats %>% mutate(month = month(date), 
                     day = day(date), 
                     week = week(date))

owid_covid_data <- read_csv("Data/owid-covid-data.csv")

peru_owid <- owid_covid_data %>% dplyr::filter(iso_code == "PER")
```

```{r ccbb, fig.align='center', fig.cap= "OverView of COVID-19 Cases & Deaths in Peru"}
options(scipen = 99)
library(ggplot2)
theme_set(theme_classic())


plot1 <- ggplot(peru_stats, aes(x=date)) + scale_x_date(date_labels = "%m-%Y") + 
  geom_line(aes(y=total_cases)) + xlab("Months") + ylab("Confirmed Cases") + scale_y_log10()

plot2 <- ggplot(peru_stats, aes(x=date)) + scale_x_date(date_labels = "%m-%Y") +
  geom_line(aes(y=total_deaths)) + xlab("Months") + ylab("Death Cases") + scale_y_log10()

gridExtra::grid.arrange(plot1, plot2)
```

In Figure \@ref(fig:ccbb), we have witnessed the tremendously increasing covid-19 cases in Peru. Unfortunately, as mentioned earlier, inspite of the fact that Peru was on of the first countries, to operate the lockdown, months of long mandatory lockdown and a night-time curfew, infections have still jumped in Peru.

The table below, provides statistics on the total number of reported positive cases of covid-19 and the total number of deaths on that specific day. These table provide us with details on the date when we found the highest number of incidents, when the rate of death increased in Peru. The simplest way to use the table is to retain information for total cases and total death in desired dates the user wants to know. Kindly note that the initial period, of the covid-19 that is the months, there were zero cases coming up in Peru and hence the you might see, a blank row for this.

```{r ttcc, fig.align='center', fig.cap="Information of the Total Cases and Deaths"}

table_for_dt <- peru_owid  %>% mutate(month = month(date),
                                                   day = day(date), 
                                                  week = week(date)) %>% 
dplyr::select(date, day, week, month, 
                total_cases,  
                total_deaths)
  
DT::datatable(table_for_dt, 
              rownames = FALSE,
              filter="top", 
              options = list(pageLength = 5, scrollX=T))
```

## Did the lockdown in Peru prove to be Effective ?

Peru is one of the hardest affected covid-19 countries in the world, with the highest rates of over-mortality. Peru, by the end of June, had put its first lockdown starting from 16 March. This lockdown took place the first time and was one of the longest lockdowns. 
In the figure \@ref(fig:ddrr), we can see the regulated environment of covid-19 in Peru during the days of lockdown when the rate of of deaths was lower and the recovery was just acceptable.

In the figure \@ref(fig:ddrr), sadly we infer that that the deaths rates of Peru have touched 4000 and above, The death rate graph,  proves to be bi modal, as we can clearly notice two peaks in the months August and September, both exceeding the rate of mortality with 3000 and more. On the other hand, on taking a closer view at the recovered rate of covid-19 patients, we infer that, the graph is multi modal, which determines that the recovery rate in Peru is unstable and we witness quite fluctuating rate of recovery in Peru.

```{r ddrr, fig.align='center', fig.cap="Death Rate and Recovered Rate in Peru"}
deathplot <- peru_covid_longer %>% 
  ggplot( aes(x = date, y = death)) + scale_x_date(date_labels = "%m-%Y") + geom_smooth()+
    geom_line() + xlab("Months") + ylab("Deaths") +
    theme(legend.position="none") +
    theme_ipsum() +
    theme(legend.position="none")

recoveredplot <- peru_covid_longer %>% 
  ggplot( aes(x = date, y = recovered)) + scale_x_date(date_labels = "%m-%Y") + geom_smooth()+
    geom_line() + xlab("Months") + ylab("Confirmed") +
    theme(legend.position="none") +
    theme_ipsum() +
    theme(legend.position="none")

gridExtra::grid.arrange(deathplot, recoveredplot)
```

This is the exact time, when the government officials of Peru had decided to lift up, the lockdown in the various stages. The implications of these were that we recorded highest numbers of death cases in Peru. On the increased mortality rates, the government authorities of Peru, once again out the country into an state of emergency, thus making masks and glove a regular part of life.

On top of that, study we saw that the, there are many explanations why the death cases and confirmed cases have not succeeded in spite of great measure by officials of the countries. The fundamental socioeconomic problems of the world due to inadequate living conditions worsen thus weakening of social distances and health related initiatives.

## Weekly Confirmed, Death, Recovered and Testing

```{r, fig.align='center', fig.cap="Weekly Confirmed Cases of COVID-19"}
peru_covid_longer %>% group_by(week) %>% summarise(max = max(confirmed)) %>% 
  ggplot(aes(x = week, y = max)) +
geom_bar(stat = "identity",fill="#f68060", alpha=.6, width=.4) + geom_smooth(se = F) +
 theme_minimal() +  
   theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face ="bold")) +
 xlab("Week") + ylab("Confirmed Cases")
    
    
```


```{r, fig.align='center', fig.cap="Weekly Deaths Cases of COVID-19"}
peru_covid_longer %>% group_by(week) %>% summarise(max = max(death)) %>% 
  ggplot(aes(x = week, y = max)) +
geom_bar(stat = "identity",fill="#228B22", alpha=.6, width=.4) + geom_smooth(se = F) +
 theme_minimal() +  
   theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face ="bold")) +
 xlab("Week") + ylab("Death Cases")
    
    
```

```{r, fig.align='center', fig.cap="Weekly Recoverey of COVID-19"}
peru_covid_longer %>% group_by(week) %>% summarise(max = max(recovered)) %>% 
  ggplot(aes(x = week, y = max)) +
geom_bar(stat = "identity",fill="#0d4762", alpha=.6, width=.4) + geom_smooth(se = F) +
 theme_minimal() +  
   theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face ="bold")) +
 xlab("Week") + ylab("Recovered Cases")
```

```{r, fig.align='center', fig.cap="Testing of COVID-19"}
df <- download_owid_testing_data(cached = TRUE, silent = TRUE)

df %>% mutate(week= week(date)) %>% group_by(week) %>% summarise(max = max(total_tests)) %>% ggplot(aes(x = week, y = max)) +
geom_bar(stat = "identity",fill="702961", alpha=.6, width=.4) + geom_smooth(se = F) +
 theme_minimal() +  
   theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face ="bold")) +
 xlab("Week") + ylab("Tested Cases")
```



```{r, fig.align='center'}
peru_stats_cases <- as.data.frame(peru_stats)
summary_statistics <-
  list(
    "Total Covid Cases in Peru" =
      list(
        "mean (sd)" = ~qwraps2::mean_sd(total_cases, na_rm = TRUE),
        "median (Q1, Q3)" = ~qwraps2::median_iqr(total_cases, na_rm = TRUE),
        "min" = ~min(total_cases, na.rm = TRUE),
        "max" = ~max(total_cases, na.rm = TRUE)
        ))
 
t1 <- summary_table(peru_stats_cases, summary_statistics) %>% kableExtra::kable(caption = "Summary Statistics of Total COVID19 Cases in Peru") %>% kableExtra::kable_styling(c("striped" , "hover"))
```

```{r, fig.align='center'}
peru_stats_deaths <- as.data.frame(peru_stats)
summary_statistics <-
  list(
    "Total Covid Cases in Peru" =
      list(
        "mean (sd)" = ~qwraps2::mean_sd(total_deaths, na_rm = TRUE),
        "median (Q1, Q3)" = ~qwraps2::median_iqr(total_deaths, na_rm = TRUE),
        "min" = ~min(total_cases, na.rm = TRUE),
        "max" = ~max(total_cases, na.rm = TRUE)
        ))
 
t2 <- summary_table(peru_stats_deaths, summary_statistics) %>% kableExtra::kable(caption = "Summary Statistics of Total COVID19 Cases in Peru") %>% kableExtra::kable_styling(c("striped" , "hover"))
```





